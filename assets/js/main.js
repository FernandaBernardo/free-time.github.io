var inphinity=function(){return this.loading=!1,this.debug=!1,this.url="",this.currentPage=1,this.itemSelector="div.post",this.nextSelector="div.navigation a:first",this.navSelector="div.navigation",this.basePath=!1,this.path=!1,this.dataType="html",this.bag=!1,this.bagClassName=!1,this.loader=!1,this.trustedRequest=!1,this.defaults={finishedMsg:"<em>That's all folks!</em>",animationSpeed:500},this.scroller=function(e){if(this.loading!==!0){var t=this.element.offsetTop+this.element.offsetHeight,i=t-e;750>=i&&(this.loading=!0,this.request())}},this.getPath=function(){var e=this.basePath;if(e.match(/^(.*?)\b2\b(.*?$)/))e=e.match(/^(.*?)\b2\b(.*?$)/).slice(1);else if(e.match(/^(.*?)2(.*?$)/)){if(e.match(/^(.*?page=)2(\/.*|$)/))return e=e.match(/^(.*?page=)2(\/.*|$)/).slice(1);e=e.match(/^(.*?)2(.*?$)/).slice(1)}else{if(e.match(/^(.*?page=)1(\/.*|$)/))return e=e.match(/^(.*?page=)1(\/.*|$)/).slice(1);this.currentPage=e.match(/\d+/)[0]-1,e=[this.path,""]}return e},this.getUrlPath=function(){var e=document.querySelector(this.nextSelector).href.split("/");return e[e.length-1]},this.createBag=function(){var e=document.createElement("div");e.style.display="none",this.bagClassName=this.bagClassName||"ph-bag",e.className=this.bagClassName,this.element.appendChild(e),this.bag=document.querySelector("."+this.bagClassName)},this.createLoader=function(){var e=document.createElement("div");e.style.display="none",e.className="ph-loader",this.element.appendChild(e),this.loader=document.querySelector(".ph-loader")},this.updateLoader=function(){this.element.removeChild(this.loader),this.createLoader()},this.loaderToggle=function(e,t){this.loader.style.display="block",e===!0?this.animation().fadeIn(this.loader,t):e===!1&&this.animation().fadeOut(this.loader,t)},this.request=function(){var e=this,t=e.path+""+(e.currentPage+1),i=new XMLHttpRequest;window.location.pathname.indexOf(e.path)>-1&&(t="../"+t),e.loaderToggle(!0),i.open("GET",encodeURI(t)),i.onload=function(){if(200===i.status||e.trustedRequest){var t=/<body[^>]*>((.|[\n\r])*)<\/body>/im.exec(i.responseText).slice(1)[0];e.trustedRequest=!0,e.loaderToggle(!1,e.render.bind(e,t))}else e._debug("Request failed. Returned status of "+i.status)},i.send()},this.render=function(e,t){var i=this;i.bag.innerHTML=e;var n=i.bag.querySelectorAll(i.itemSelector);if(!n.length)return i.finished();if(t!==!0){var a=document.querySelector(i.navSelector);return i.animation().fadeOut(a,function(){return i.render(e,!0)})}for(var s=0;s<n.length;s++)i.element.appendChild(n[s]);i.toNext()},this.toNext=function(){this.updateLoader(),this.currentPage=this.currentPage+1,this.loading=!1},this.finished=function(){var e=document.createElement("div");e.className="ph-end",e.innerHTML=this.defaults.finishedMsg,this.element.appendChild(e)},this.on=function(e){return this.sel=e,this.element=document.querySelector(e),this},this.set=function(e){e.navSelector&&(this.navSelector=e.navSelector),e.nextSelector&&(this.nextSelector=e.nextSelector),e.itemSelector&&(this.itemSelector=e.itemSelector),e.path&&(this.path=e.path),e.basePath&&(this.basePath=e.basePath),e.finishedMsg&&(this.defaults.finishedMsg=e.finishedMsg),e.animationSpeed&&(this.defaults.animationSpeed=e.animationSpeed,"slow"===e.animationSpeed&&(this.defaults.animationSpeed=800),"normal"===e.animationSpeed&&(this.defaults.animationSpeed=500),"fast"===e.animationSpeed&&(this.defaults.animationSpeed=300)),this.init()},this.init=function(){this.basePath=this.basePath||this.getUrlPath(),this.path=this.path||this.getPath()[0]||"page",this.createLoader(),this.createBag(),this.setEventScroll()},this.setEventScroll=function(){var e=this;window.addEventListener("scroll",function(t){e.scroller(window.scrollY||t.target.activeElement.scrollTop)})},this._debug=function(e){console.log("Inphinity: ",e)},this.animation=function(){var e=this;return{fadeOut:function(t,i){t.style.opacity=1;var n=+new Date,a=function(){if(t.style.opacity=+t.style.opacity-(new Date-n)/e.defaults.animationSpeed,n=+new Date,+t.style.opacity>0)window.requestAnimationFrame&&requestAnimationFrame(a)||setTimeout(a,16);else{if(t.style.display="none","undefined"==typeof i)return!0;i()}};a()},fadeIn:function(t,i){t.style.opacity=0;var n=+new Date,a=function(){if(t.style.opacity=+t.style.opacity+(new Date-n)/e.defaults.animationSpeed,n=+new Date,+t.style.opacity<1)window.requestAnimationFrame&&requestAnimationFrame(a)||setTimeout(a,16);else{if("undefined"==typeof i)return!0;i()}};a()}}},this.on.bind(this)}();!function(e,t){"function"==typeof define&&define.amd?define(function(){return t(e)}):"object"==typeof exports?module.exports=t:e.echo=t(e)}(this,function(e){"use strict";var t,i,n,a,s,o={},r=function(){},h=function(e){return null===e.offsetParent},l=function(e,t){if(h(e))return!1;var i=e.getBoundingClientRect();return i.right>=t.l&&i.bottom>=t.t&&i.left<=t.r&&i.top<=t.b},d=function(){(a||!i)&&(clearTimeout(i),i=setTimeout(function(){o.render(),i=null},n))};return o.init=function(i){i=i||{};var h=i.offset||0,l=i.offsetVertical||h,c=i.offsetHorizontal||h,u=function(e,t){return parseInt(e||t,10)};t={t:u(i.offsetTop,l),b:u(i.offsetBottom,l),l:u(i.offsetLeft,c),r:u(i.offsetRight,c)},n=u(i.throttle,250),a=i.debounce!==!1,s=!!i.unload,r=i.callback||r,o.render(),document.addEventListener?(e.addEventListener("scroll",d,!1),e.addEventListener("load",d,!1)):(e.attachEvent("onscroll",d),e.attachEvent("onload",d))},o.render=function(){for(var i,n,a=document.querySelectorAll("img[data-echo], [data-echo-background]"),h=a.length,d={l:0-t.l,t:0-t.t,b:(e.innerHeight||document.documentElement.clientHeight)+t.b,r:(e.innerWidth||document.documentElement.clientWidth)+t.r},c=0;h>c;c++)n=a[c],l(n,d)?(s&&n.setAttribute("data-echo-placeholder",n.src),null!==n.getAttribute("data-echo-background")?n.style.backgroundImage="url("+n.getAttribute("data-echo-background")+")":n.src=n.getAttribute("data-echo"),s||(n.removeAttribute("data-echo"),n.removeAttribute("data-echo-background")),r(n,"load")):s&&(i=n.getAttribute("data-echo-placeholder"))&&(null!==n.getAttribute("data-echo-background")?n.style.backgroundImage="url("+i+")":n.src=i,n.removeAttribute("data-echo-placeholder"),r(n,"unload"));h||o.detach()},o.detach=function(){document.removeEventListener?e.removeEventListener("scroll",d):e.detachEvent("onscroll",d),clearTimeout(i)},o});var inphinity=function(){return this.loading=!1,this.debug=!1,this.url="",this.currentPage=1,this.itemSelector="div.post",this.nextSelector="div.navigation a:first",this.navSelector="div.navigation",this.basePath=!1,this.path=!1,this.dataType="html",this.bag=!1,this.bagClassName=!1,this.loader=!1,this.trustedRequest=!1,this.defaults={finishedMsg:"<em>That's all folks!</em>",animationSpeed:500},this.scroller=function(e){if(this.loading!==!0){var t=this.element.offsetTop+this.element.offsetHeight,i=t-e;750>=i&&(this.loading=!0,this.request())}},this.getPath=function(){var e=this.basePath;if(e.match(/^(.*?)\b2\b(.*?$)/))e=e.match(/^(.*?)\b2\b(.*?$)/).slice(1);else if(e.match(/^(.*?)2(.*?$)/)){if(e.match(/^(.*?page=)2(\/.*|$)/))return e=e.match(/^(.*?page=)2(\/.*|$)/).slice(1);e=e.match(/^(.*?)2(.*?$)/).slice(1)}else{if(e.match(/^(.*?page=)1(\/.*|$)/))return e=e.match(/^(.*?page=)1(\/.*|$)/).slice(1);this.currentPage=e.match(/\d+/)[0]-1,e=[this.path,""]}return e},this.getUrlPath=function(){var e=document.querySelector(this.nextSelector).href.split("/");return e[e.length-1]},this.createBag=function(){var e=document.createElement("div");e.style.display="none",this.bagClassName=this.bagClassName||"ph-bag",e.className=this.bagClassName,this.element.appendChild(e),this.bag=document.querySelector("."+this.bagClassName)},this.createLoader=function(){var e=document.createElement("div");e.style.display="none",e.className="ph-loader",this.element.appendChild(e),this.loader=document.querySelector(".ph-loader")},this.updateLoader=function(){this.element.removeChild(this.loader),this.createLoader()},this.loaderToggle=function(e,t){this.loader.style.display="block",e===!0?this.animation().fadeIn(this.loader,t):e===!1&&this.animation().fadeOut(this.loader,t)},this.request=function(){var e=this,t=e.path+""+(e.currentPage+1),i=new XMLHttpRequest;window.location.pathname.indexOf(e.path)>-1&&(t="../"+t),e.loaderToggle(!0),i.open("GET",encodeURI(t)),i.onload=function(){if(200===i.status||e.trustedRequest){var t=/<body[^>]*>((.|[\n\r])*)<\/body>/im.exec(i.responseText).slice(1)[0];e.trustedRequest=!0,e.loaderToggle(!1,e.render.bind(e,t))}else e._debug("Request failed. Returned status of "+i.status)},i.send()},this.render=function(e,t){var i=this;i.bag.innerHTML=e;var n=i.bag.querySelectorAll(i.itemSelector);if(!n.length)return i.finished();if(t!==!0){var a=document.querySelector(i.navSelector);return i.animation().fadeOut(a,function(){return i.render(e,!0)})}for(var s=0;s<n.length;s++)i.element.appendChild(n[s]);i.toNext()},this.toNext=function(){this.updateLoader(),this.currentPage=this.currentPage+1,this.loading=!1},this.finished=function(){var e=document.createElement("div");e.className="ph-end",e.innerHTML=this.defaults.finishedMsg,this.element.appendChild(e)},this.on=function(e){return this.sel=e,this.element=document.querySelector(e),this},this.set=function(e){e.navSelector&&(this.navSelector=e.navSelector),e.nextSelector&&(this.nextSelector=e.nextSelector),e.itemSelector&&(this.itemSelector=e.itemSelector),e.path&&(this.path=e.path),e.basePath&&(this.basePath=e.basePath),e.finishedMsg&&(this.defaults.finishedMsg=e.finishedMsg),e.animationSpeed&&(this.defaults.animationSpeed=e.animationSpeed,"slow"===e.animationSpeed&&(this.defaults.animationSpeed=800),"normal"===e.animationSpeed&&(this.defaults.animationSpeed=500),"fast"===e.animationSpeed&&(this.defaults.animationSpeed=300)),this.init()},this.init=function(){this.basePath=this.basePath||this.getUrlPath(),this.path=this.path||this.getPath()[0]||"page",this.createLoader(),this.createBag(),this.setEventScroll()},this.setEventScroll=function(){var e=this;window.addEventListener("scroll",function(t){e.scroller(window.scrollY||t.target.activeElement.scrollTop)})},this._debug=function(e){console.log("Inphinity: ",e)},this.animation=function(){var e=this;return{fadeOut:function(t,i){t.style.opacity=1;var n=+new Date,a=function(){if(t.style.opacity=+t.style.opacity-(new Date-n)/e.defaults.animationSpeed,n=+new Date,+t.style.opacity>0)window.requestAnimationFrame&&requestAnimationFrame(a)||setTimeout(a,16);else{if(t.style.display="none","undefined"==typeof i)return!0;i()}};a()},fadeIn:function(t,i){t.style.opacity=0;var n=+new Date,a=function(){if(t.style.opacity=+t.style.opacity+(new Date-n)/e.defaults.animationSpeed,n=+new Date,+t.style.opacity<1)window.requestAnimationFrame&&requestAnimationFrame(a)||setTimeout(a,16);else{if("undefined"==typeof i)return!0;i()}};a()}}},this.on.bind(this)}();